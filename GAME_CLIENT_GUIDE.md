# 🎮 WePoker Web 游戏客户端 - 完整使用指南

## 📱 功能介绍

这个 Web 客户端提供了一个完整的、可在浏览器中直接使用的德州扑克游戏体验：

### ✨ 核心功能
- ✅ **实时游戏**：与其他玩家同时进行德州扑克游戏
- ✅ **房间分享**：生成分享链接，朋友点击即可加入
- ✅ **实时同步**：通过 WebSocket 实时同步游戏状态
- ✅ **完整操作**：支持所有德州扑克操作（过牌、跟注、弃牌、加注、全下）
- ✅ **多人游戏**：支持 2-6 人同时游戏
- ✅ **自动计时**：每个玩家的操作都有倒计时限制

---

## 🚀 快速开始（3 步）

### 第 1 步：启动后端服务

```bash
# 进入项目目录
cd /workspaces/Texas-Poker

# 启动依赖服务
docker-compose up -d

# 启动应用
mvn spring-boot:run
```

等待看到：
```
WePoker Texas Hold'em Backend started on 0.0.0.0:9000
Server started on port 8080
```

### 第 2 步：打开游戏网页

在浏览器中访问：
```
http://localhost:8080
```

### 第 3 步：加入房间开始游戏

1. 输入你的昵称（2-20 个字符）
2. 输入买入金额（¥50-¥5000）
3. 点击"加入房间"
4. 复制房间链接分享给朋友

---

## 🎯 游戏流程指南

### 第一次进入

```
1. 页面加载
   ↓
2. 输入昵称和买入金额
   ↓
3. 点击"加入房间"
   ↓
4. 系统自动为你分配座位
   ↓
5. 房间链接自动生成（可复制分享）
   ↓
6. 等待其他玩家加入或游戏开始
```

### 邀请朋友

```
1. 页面右侧"邀请朋友"面板
   ↓
2. 点击"复制"按钮
   ↓
3. 分享链接给朋友（微信、QQ、邮件等）
   ↓
4. 朋友点击链接
   ↓
5. 自动进入同一个房间
```

### 游戏操作

**轮到你操作时，可进行以下操作：**

| 操作 | 说明 | 快捷键 |
|------|------|--------|
| **过牌** | 不下注，进入下一轮 | P |
| **跟注** | 下注相同金额 | C |
| **弃牌** | 放弃这手牌 | F |
| **下注** | 输入金额后点击"下注" | B |
| **加注** | 增加下注额度 | R |
| **全下** | 将所有筹码投入 | A |

### 游戏状态说明

```
等待中   → 等待玩家加入或游戏开始
发牌中   → 系统正在发牌
翻牌前   → 发了两张底牌，第一轮下注
翻牌     → 发了 3 张社区牌，第二轮下注
转牌     → 发了第 4 张社区牌，第三轮下注
河牌     → 发了第 5 张社区牌，最后一轮下注
秀牌     → 各玩家亮牌，比较牌力
结算中   → 计算赢家，分配底池
```

---

## 🎮 完整的游戏示例

### 场景：3 个玩家，小盲注 ¥5，大盲注 ¥10

```
初始状态：
┌─────────────────────────────────────────┐
│  玩家 A: ¥1000  玩家 B: ¥1000          │
│  玩家 C: ¥1000  (我: ¥1000)            │
│                                         │
│  底池: ¥0                              │
│  游戏状态: 等待中                       │
└─────────────────────────────────────────┘

第 1 步：大盲前 (Pre-flop)
├─ 玩家 B 下盲注 ¥5（小盲）
├─ 玩家 C 下盲注 ¥10（大盲）
├─ 玩家 A 需要操作
│  └─ 选择：跟注 ¥10 / 加注 / 弃牌
└─ 底池: ¥15

第 2 步：翻牌 (Flop)
├─ 发 3 张社区牌
├─ 下注轮次 2
└─ 底池: ¥30

第 3 步：转牌 (Turn)
├─ 发第 4 张社区牌
├─ 下注轮次 3
└─ 底池: ¥50

第 4 步：河牌 (River)
├─ 发第 5 张社区牌
├─ 下注轮次 4
└─ 底池: ¥100

第 5 步：秀牌 (Showdown)
├─ 玩家 A: KK → 一对
├─ 玩家 B: AK → 一对 A
├─ 玩家 C 弃牌
│
└─ 赢家：玩家 B (一对 A)
   奖励：¥100 (扣除 ¥5 抽水后)
```

---

## 📊 界面说明

### 左侧：牌桌主区

```
            玩家 0
               ↑
    玩家 7              玩家 1
    ↓                      ↓
玩家 6   ┌──────────────┐   玩家 2
    ↓   │  底池: ¥100  │   ↓
        │  社区牌:    │
        │  A♠ K♦ Q♣  │
玩家 5   │  J♥ 10♠    │   玩家 3
    ↑   └──────────────┘   ↑
            玩家 4
```

每个玩家显示：
- 👤 昵称
- 💰 筹码金额
- 📊 状态（活跃/弃牌/全下）

### 右侧：操作面板

```
┌─────────────────────┐
│ 📊 游戏信息         │
├─────────────────────┤
│ 状态: 翻牌前        │
│ 盲注: ¥5 / ¥10     │
│ 当前: 玩家 A        │
│ 玩家数: 3/6        │
├─────────────────────┤
│ 👤 我的信息         │
├─────────────────────┤
│ 昵称: Player1       │
│ 筹码: ¥950         │
│ 座位: 1             │
│ 状态: 活跃          │
├─────────────────────┤
│ 🔗 邀请朋友         │
├─────────────────────┤
│ [复制链接]         │
├─────────────────────┤
│ ⏱️ 剩余: 15s       │
├─────────────────────┤
│ [过牌] [跟注]       │
│ [弃牌] [加注]       │
│ [输入金额] [下注]   │
│ [全下]              │
│ [离开房间]          │
└─────────────────────┘
```

---

## 🔗 房间链接机制

### 如何分享房间

1. **进入游戏后**，右侧面板会显示分享链接：
   ```
   http://localhost:8080?table=123456
   ```

2. **复制链接**，通过任何方式（微信、QQ、邮件等）分享给朋友

3. **朋友点击链接**，自动进入同一个房间

### 链接格式说明

```
http://localhost:8080?table=XXXXX

参数说明：
table=XXXXX  → 房间 ID，唯一标识一个牌桌
```

### 生产环境链接示例

```
// 假设服务器部署在 poker.example.com
http://poker.example.com?table=123456

// 朋友点击此链接，自动进入房间 123456
```

---

## ⚙️ 配置和自定义

### 修改盲注大小

编辑 `src/main/resources/application.yml`：

```yaml
wepoker:
  game:
    blinds:
      small: 5      # 小盲注 ¥0.05
      big: 10       # 大盲注 ¥0.10
```

### 修改倒计时

```yaml
wepoker:
  game:
    actionTimeoutDefault: 15    # 改成 20 秒
    actionTimeoutExtended: 30   # 延时时间
```

### 修改游戏端口

编辑 `application.yml`：

```yaml
server:
  port: 8080                    # HTTP 端口（Web 页面）

wepoker:
  netty:
    port: 9000                  # WebSocket 端口
```

---

## 🐛 常见问题与排查

### Q1：点击加入后一直显示"连接中"

**解决方案：**
```bash
# 检查后端是否正在运行
curl http://localhost:8080/api/game/health

# 如果无响应，重启应用
mvn spring-boot:run
```

### Q2：链接分享给朋友后他无法进入

**检查清单：**
- ✓ 确保他点击的是完整的链接（包含 ?table=XXXXX）
- ✓ 确保后端服务仍在运行
- ✓ 如果在本地网络，使用 IP 地址而不是 localhost
  ```
  http://192.168.1.100:8080?table=123456
  ```

### Q3：刷新页面后找不到之前的房间

**原因**：每次刷新会重新分配新的玩家 ID

**解决方案**：
- 不刷新页面，关闭当前标签页
- 重新点击分享链接加入房间

### Q4：社区牌显示不了

**检查**：
- 游戏状态是否已经到达翻牌/转牌/河牌阶段
- 如果显示"?"，说明牌还没有发出来

### Q5：按钮不可用

**原因**：这些情况下操作按钮会被禁用：
- 当前不是你的操作轮次
- 你的筹码已用完 (All-in)
- 你已经弃牌

---

## 📱 移动设备支持

Web 客户端已针对移动设备进行优化：

**支持的设备：**
- ✅ iPhone/iPad (iOS 12+)
- ✅ Android 手机/平板 (Android 5+)
- ✅ 桌面浏览器 (Chrome, Firefox, Safari, Edge)

**在手机上使用：**
```
1. 在手机浏览器输入服务器地址
   例: http://您的IP:8080?table=123456

2. 页面会自动适应手机屏幕

3. 分享链接给朋友，朋友发送链接到自己手机上打开
```

---

## 🎥 游戏录制和回放

目前版本不支持，但可以通过浏览器开发者工具录制：

```bash
# Chrome 开发者工具 (F12)
1. 打开 Console
2. 在 gameState 对象中可以看到所有游戏状态
3. 可导出数据用于分析

# 查看实时消息
console.log(gameState)
```

---

## 🔒 安全注意事项

### 本地网络（局域网）

如果在局域网中使用本系统，确保：

```bash
1. 只在信任的网络中使用
2. 防火墙规则
   - 关闭公网访问
   - 仅允许局域网内 IP 访问

3. 如果需要公网访问
   - 部署 HTTPS
   - 添加身份认证
   - 实施 DDoS 防护
```

### 数据安全

```
✓ 金额计算在服务端进行，不依赖客户端
✓ 所有操作都由服务端验证
✓ 不存储敏感信息在浏览器本地
```

---

## 💡 高级用法

### 自定义尼称和头像

目前版本仅支持文字昵称，计划在未来版本中添加：
- 头像支持
- 玩家统计信息
- 成就系统

### 与自己的系统集成

如果想将此游戏集成到自己的平台：

```javascript
// 嵌入到 iframe
<iframe src="http://您的服务器:8080?table=123456" 
        width="100%" height="100%">
</iframe>

// 或使用 API
fetch('http://您的服务器:8080/api/game/tables')
  .then(res => res.json())
  .then(data => console.log(data))
```

---

## 📞 技术支持

### 查看日志

```bash
# 查看应用日志
tail -f logs/wepoker.log

# 查看 Docker 日志
docker logs wepoker-mysql
docker logs wepoker-redis

# 查看浏览器控制台
按 F12 → Console 标签页
```

### 常见错误代码

| 错误代码 | 说明 | 解决方案 |
|---------|------|---------|
| `PROCESS_ERROR` | 处理消息出错 | 刷新页面重试 |
| `CONNECTION_ERROR` | 连接失败 | 检查服务器状态 |
| `INVALID_ACTION` | 非法操作 | 确认游戏状态 |

---

## 🎓 进阶

### 自定义 UI 主题

编辑 `src/main/resources/static/index.html` 中的 CSS：

```css
/* 修改主题颜色 */
:root {
  --primary-color: #ffd700;  /* 金色
  --bg-color: #0f4c27;       /* 牌桌绿
  --text-color: #ffffff;     /* 白色
}
```

### 添加聊天功能

可以扩展 WebSocket 协议，添加聊天消息类型：

```javascript
// 发送聊天
{
  "type": "CHAT",
  "payload": {
    "message": "Great hand!"
  }
}
```

---

## ✅ 完整检查清单

- [ ] 后端服务已启动 (8080 + 9000 端口)
- [ ] 可以访问 http://localhost:8080
- [ ] 可以成功加入房间
- [ ] 房间链接可以正常复制
- [ ] 朋友可以点击链接进入同一房间
- [ ] 游戏状态可以实时同步
- [ ] 所有操作按钮都能正常工作
- [ ] 金额显示正确（¥为单位）
- [ ] 倒计时正常工作

---

**祝你游戏愉快！🎉**

如有问题，查看后台日志或 F12 浏览器控制台，获取更详细的错误信息。
