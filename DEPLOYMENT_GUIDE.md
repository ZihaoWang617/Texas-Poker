# ğŸš€ WePoker å®Œæ•´éƒ¨ç½²å’Œå¯åŠ¨æŒ‡å—

## ğŸ“‹ ä¸€å¥è¯æ€»ç»“

> **ä¸€é”®å¯åŠ¨ï¼Œæœ‹å‹ç‚¹é“¾æ¥å°±èƒ½ç©ï¼**

---

## ğŸ¯ 5 åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨

### æ–¹å¼ 1ï¼šä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /workspaces/Texas-Poker

# 2. å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆMySQL + Redis + åº”ç”¨ï¼‰
docker-compose up -d

# 3. ç­‰å¾… 30 ç§’ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€
echo "ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 30

# 4. åœ¨æµè§ˆå™¨æ‰“å¼€
# Mac/Linux
open http://localhost:8080

# Windows
start http://localhost:8080
```

**å°±è¿™ä¹ˆç®€å•ï¼** âœ…

---

### æ–¹å¼ 2ï¼šæœ¬åœ°è¿è¡Œï¼ˆéœ€è¦æœ¬åœ° MySQL å’Œ Redisï¼‰

```bash
# 1. ç¡®ä¿ä½ å®‰è£…äº†
java --version       # Java 21+
mvn --version        # Maven 3.8+
mysql --version      # MySQL 8.0+
redis-cli --version  # Redis 7.2+

# 2. å¯åŠ¨ MySQL å’Œ Redis
redis-server         # ä¸€ä¸ªç»ˆç«¯çª—å£
mysql -u root        # å¦ä¸€ä¸ªç»ˆç«¯çª—å£

# 3. åˆå§‹åŒ–æ•°æ®åº“
mysql -u root -p < schema.sql

# 4. è¿è¡Œåº”ç”¨
mvn clean spring-boot:run

# 5. æµè§ˆå™¨æ‰“å¼€
http://localhost:8080
```

---

## ğŸ® å¯åŠ¨åçš„æ“ä½œæµç¨‹

### ç¬¬ 1 æ­¥ï¼šè¿›å…¥æ¸¸æˆ

```
1. æµè§ˆå™¨æ‰“å¼€ï¼šhttp://localhost:8080
   
2. çœ‹åˆ°"åŠ å…¥æˆ¿é—´"å¯¹è¯æ¡†

3. è¾“å…¥ï¼š
   æ˜µç§°: ä½ çš„åå­—
   ä¹°å…¥: 500 (Â¥)

4. ç‚¹å‡»"åŠ å…¥æˆ¿é—´"

âœ… ä½ å·²æˆåŠŸè¿›å…¥æ¸¸æˆï¼
```

### ç¬¬ 2 æ­¥ï¼šé‚€è¯·æœ‹å‹

```
1. é¡µé¢å³ä¾§æ‰¾åˆ°"é‚€è¯·æœ‹å‹"

2. å¤åˆ¶æˆ¿é—´é“¾æ¥
   URL: http://localhost:8080?table=123456

3. å‘é€ç»™æœ‹å‹
   å¾®ä¿¡ / QQ / é‚®ä»¶ / ä»»ä½•æ–¹å¼

4. æœ‹å‹ç‚¹å‡»é“¾æ¥ï¼Œè‡ªåŠ¨è¿›å…¥ä½ çš„æˆ¿é—´

âœ… æœ‹å‹æˆåŠŸåŠ å…¥ï¼
```

### ç¬¬ 3 æ­¥ï¼šå¼€å§‹æ¸¸æˆ

```
ç­‰äººæ•°è¾¾åˆ° 2 äººæˆ–ä»¥ä¸Šï¼Œæ¸¸æˆè‡ªåŠ¨å¼€å§‹

ä½ å¯ä»¥ï¼š
- ğŸ´ ä¸‹æ³¨ / è·Ÿæ³¨ / åŠ æ³¨
- ğŸš« å¼ƒç‰Œ
- ğŸ’° å…¨ä¸‹
- ğŸ”„ çœ‹å®æ—¶åº•æ± å’Œç¤¾åŒºç‰Œ

æ¸¸æˆæµç¨‹å¾ˆç›´è§‚ï¼Œç•Œé¢ä¼šå‘Šè¯‰ä½ è¯¥åšä»€ä¹ˆï¼
```

---

## ğŸ“Š å„ç§å¯åŠ¨æ–¹å¼å¯¹æ¯”

| æ–¹å¼ | å¤æ‚åº¦ | é€Ÿåº¦ | æ¨èåº¦ |
|------|-------|------|--------|
| Docker Compose | æœ€ä½ | å¿« | â­â­â­â­â­ |
| æœ¬åœ° Maven | ä¸­ç­‰ | ä¸­ç­‰ | â­â­â­ |
| JAR æ‰“åŒ… | ä½ | å¿« | â­â­â­â­ |
| äº‘æœåŠ¡å™¨ | é«˜ | æœ€å¿« | â­â­â­â­â­ |

---

## ğŸ“¦ å¦‚æœä½ æƒ³æ‰“åŒ…éƒ¨ç½²

### æ–¹å¼ 3ï¼šç¼–è¯‘æˆ JAR éƒ¨ç½²

```bash
# ç¼–è¯‘æ‰“åŒ…
mvn clean package

# è¿è¡Œ JARï¼ˆéœ€è¦ MySQL å’Œ Redis å·²å¯åŠ¨ï¼‰
java -jar target/texas-poker-1.0.0.jar

# æˆ–ä½¿ç”¨ Java 21 è™šæ‹Ÿçº¿ç¨‹ï¼ˆæ€§èƒ½æœ€å¥½ï¼‰
java --enable-preview -jar target/texas-poker-1.0.0.jar
```

### æ–¹å¼ 4ï¼šéƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨

**å‰ç½®æ¡ä»¶ï¼š**
- ä¸€å° Linux æœåŠ¡å™¨
- Docker å·²å®‰è£…
- å…¬ç½‘ IP

**éƒ¨ç½²æ­¥éª¤ï¼š**

```bash
# 1. å°†é¡¹ç›®ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r Texas-Poker/ user@server:/opt/

# 2. è¿æ¥åˆ°æœåŠ¡å™¨
ssh user@server

# 3. è¿›å…¥ç›®å½•
cd /opt/Texas-Poker

# 4. ä¿®æ”¹é…ç½®ï¼ˆå¯é€‰ï¼‰
# ç¼–è¾‘ docker-compose.ymlï¼Œæš´éœ²ç«¯å£
vi docker-compose.yml

# 5. å¯åŠ¨
docker-compose up -d

# 6. æ£€æŸ¥çŠ¶æ€
docker-compose ps

# 7. åœ¨æµè§ˆå™¨æ‰“å¼€
# http://ä½ çš„æœåŠ¡å™¨IP:8080?table=123456
```

---

## âœ… å¯åŠ¨æ£€æŸ¥æ¸…å•

å¯åŠ¨åº”ç”¨åï¼Œç¡®è®¤æ‰€æœ‰é¡¹éƒ½ âœ…ï¼š

```
â–¡ èƒ½è®¿é—® http://localhost:8080
â–¡ é¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼ˆç»¿è‰²ç‰Œæ¡Œï¼‰
â–¡ å¯ä»¥è¾“å…¥æ˜µç§°å’Œä¹°å…¥é‡‘é¢
â–¡ å¯ä»¥ç‚¹å‡»"åŠ å…¥æˆ¿é—´"
â–¡ å³ä¾§æ˜¾ç¤ºæˆ¿é—´é“¾æ¥
â–¡ æˆ¿é—´é“¾æ¥å¯ä»¥å¤åˆ¶
â–¡ é¡µé¢å³ä¸Šè§’æ˜¾ç¤º"å·²è¿æ¥"ï¼ˆç»¿è‰²ï¼‰
â–¡ å€’è®¡æ—¶æ­£å¸¸å·¥ä½œ
â–¡ èƒ½è¿›è¡Œæ¸¸æˆæ“ä½œ
```

å¦‚æœæŸé¡¹ä¸é€šè¿‡ï¼ŒæŸ¥çœ‹ä¸‹é¢çš„æ•…éšœæ’æŸ¥ã€‚

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæ— æ³•è®¿é—® http://localhost:8080

**ç—‡çŠ¶ï¼š**
```
æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ / è¿æ¥è¢«æ‹’ç»
```

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿è¡Œ
nvsc lsof -i :8080

# åº”è¯¥çœ‹åˆ° java è¿›ç¨‹ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‡å¯åº”ç”¨
mvn spring-boot:run
```

### é—®é¢˜ 2ï¼šåŠ å…¥æˆ¿é—´åä¸€ç›´åŠ è½½ä¸­

**ç—‡çŠ¶ï¼š**
```
çœ‹åˆ°è½¬åœˆåŠ è½½ï¼Œä½†æ²¡ååº”
```

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥åç«¯æ˜¯å¦æ­£å¸¸
curl http://localhost:8080/api/game/health

# åº”è¯¥è¿”å›ï¼š{"code":200,"message":"OK","data":null}

# å¦‚æœæ²¡æœ‰è¿”å›ï¼Œæ£€æŸ¥åº”ç”¨æ—¥å¿—
mvn spring-boot:run  # æŸ¥çœ‹è¾“å‡ºä¸­çš„é”™è¯¯
```

### é—®é¢˜ 3ï¼šé¡µé¢å³ä¸Šè§’æ˜¾ç¤º"æœªè¿æ¥"

**ç—‡çŠ¶ï¼š**
```
è¿æ¥çŠ¶æ€ä¸€ç›´æ˜¯çº¢è‰²çš„
```

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥ Netty æœåŠ¡å™¨ï¼ˆWebSocketï¼‰
curl http://localhost:9000/

# åº”è¯¥è¿”å›é”™è¯¯ï¼ˆå› ä¸º HTTP ä¸é€šè¿‡ WebSocketï¼‰ï¼Œ
# ä½†å¦‚æœæ ¹æœ¬æ— æ³•è¿æ¥ï¼Œè¯´æ˜ Netty æ²¡å¯åŠ¨

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼Œåº”è¯¥æœ‰ï¼š
# "Netty Game Server started on 0.0.0.0:9000"
```

### é—®é¢˜ 4ï¼šMySQL è¿æ¥å¤±è´¥

**ç—‡çŠ¶ï¼š**
```
Error: unable to access database
```

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥ MySQL æ˜¯å¦è¿è¡Œ
docker ps | grep mysql

# å¦‚æœçœ‹ä¸åˆ° wepoker-mysqlï¼Œå¯åŠ¨å®ƒ
docker-compose up -d wepoker-mysql

# æ£€æŸ¥è¿æ¥
docker exec -it wepoker-mysql mysql -u root -proot -e "SELECT 1;"

# åº”è¯¥è¿”å›ï¼š1
```

### é—®é¢˜ 5ï¼šæœ‹å‹æ— æ³•è¿›å…¥æˆ¿é—´

**ç—‡çŠ¶ï¼š**
```
æœ‹å‹ç‚¹å‡»é“¾æ¥åçœ‹ä¸åˆ°ä½ çš„æˆ¿é—´
```

**åŸå› ï¼š**é“¾æ¥ä¸å¯¹ã€ç«¯å£ä¸é€šã€æˆ–æ˜¯ä¸åŒçš„ç½‘ç»œ

**è§£å†³ï¼š**

å¦‚æœæœ‹å‹åœ¨åŒä¸€å±€åŸŸç½‘ï¼š
```bash
# ä½¿ç”¨ IP åœ°å€è€Œä¸æ˜¯ localhost
# æŸ¥çœ‹ä½ çš„ IP
ipconfig  # Windows
ifconfig  # Mac/Linux

# é“¾æ¥æ ¼å¼ï¼š
# http://192.168.1.100:8080?table=123456
```

å¦‚æœæœ‹å‹åœ¨ä¸åŒç½‘ç»œï¼š
```bash
# éœ€è¦éƒ¨ç½²åˆ°å…¬ç½‘æœåŠ¡å™¨
# æˆ–å»ºç«‹ VPN/å†…ç½‘ç©¿é€
# æˆ–ä½¿ç”¨ frp ç­‰å·¥å…·
```

### é—®é¢˜ 6ï¼šæ¸¸æˆæ—¶é’±æ•°ä¸å¯¹

**ç—‡çŠ¶ï¼š**
```
ä¸‹æ³¨ 100 å…ƒï¼Œæ˜¾ç¤ºæ‰£é™¤äº† 1 å…ƒ
```

**åŸå› ï¼š**é‡‘é¢å•ä½é—®é¢˜

**æ³¨æ„ï¼š**
```
ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨"åˆ†"ä¸ºå•ä½ï¼š
Â¥1 = 100 åˆ†

å¦‚æœæ˜¾ç¤ºä¸å¯¹ï¼Œè¯´æ˜å‰ç«¯è½¬æ¢æœ‰é—®é¢˜ã€‚
æŸ¥çœ‹æµè§ˆå™¨ F12 â†’ æ§åˆ¶å°
```

---

## ğŸ¨ è‡ªå®šä¹‰é…ç½®

### æ›´æ”¹ä¾¦å¬ç«¯å£

**ç¼–è¾‘ï¼š** `src/main/resources/application.yml`

```yaml
# æ›´æ”¹ HTTP ç«¯å£ï¼ˆWeb é¡µé¢ï¼‰
server:
  port: 8080  # æ”¹æˆå…¶ä»–ç«¯å£å¦‚ 3000

# æ›´æ”¹ Netty ç«¯å£ï¼ˆWebSocketï¼‰
wepoker:
  netty:
    port: 9000  # æ”¹æˆå…¶ä»–ç«¯å£å¦‚ 9001
```

**é‡å¯åº”ç”¨ä½¿é…ç½®ç”Ÿæ•ˆã€‚**

### ä¿®æ”¹ç›²æ³¨å¤§å°

```yaml
wepoker:
  game:
    smallBlind: 5    # å°ç›²æ³¨ Â¥5 åˆ† = Â¥0.05
    bigBlind: 10     # å¤§ç›²æ³¨ Â¥10 åˆ† = Â¥0.10
```

### ä¿®æ”¹å€’è®¡æ—¶

```yaml
wepoker:
  game:
    actionTimeoutDefault: 15  # æ ‡å‡†å€’è®¡æ—¶ 15 ç§’
    actionTimeoutExtended: 30  # å»¶æ—¶å€’è®¡æ—¶ 30 ç§’
```

---

## ğŸŒ å¦‚ä½•åœ¨å…¬ç½‘ä¸Šéƒ¨ç½²

å‡è®¾ä½ è¦è®©æœ‹å‹åœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½ç©ï¼š

### æ–¹æ¡ˆ 1ï¼šä½¿ç”¨äº‘æœåŠ¡å™¨ï¼ˆAWS / é˜¿é‡Œäº‘ / è…¾è®¯äº‘ï¼‰

```bash
# 1. è´­ä¹°æœåŠ¡å™¨ï¼ˆæ¨è Linuxï¼‰
#    æœ€ä½é…ç½®ï¼š1 æ ¸ CPUï¼Œ2GB RAMï¼Œ20GB å­˜å‚¨

# 2. è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@æœåŠ¡å™¨IP

# 3. å®‰è£…å¿…è¦è½¯ä»¶
apt-get update
apt-get install -y docker.io docker-compose openjdk-21-jdk maven

# 4. ä¸Šä¼ é¡¹ç›®
# æ–¹æ³• A: git clone
git clone https://github.com/ä½ çš„è´¦æˆ·/Texas-Poker.git

# æ–¹æ³• B: scp ä¸Šä¼ 
scp -r Texas-Poker/ root@æœåŠ¡å™¨IP:/opt/

# 5. å¯åŠ¨åº”ç”¨
cd /opt/Texas-Poker
docker-compose up -d

# 6. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
# ç¡®ä¿ 8080 å’Œ 9000 ç«¯å£å¼€æ”¾

# ç°åœ¨å¯ä»¥åˆ†äº«é“¾æ¥äº†ï¼š
# http://æœåŠ¡å™¨IP:8080?table=123456
```

### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ Docker Hubï¼ˆå®¹å™¨é•œåƒï¼‰

```bash
# 1. æ‰“åŒ… Docker é•œåƒ
# é¦–å…ˆåˆ›å»º Dockerfileï¼ˆå¯é€‰ï¼Œç³»ç»Ÿå·²åŒ…å«ï¼‰

# 2. æ¨é€åˆ° Docker Hub
docker build -t wepoker:latest .
docker tag wepoker:latest ä½ çš„Dockerç”¨æˆ·å/wepoker:latest
docker push ä½ çš„Dockerç”¨æˆ·å/wepoker:latest

# 3. åœ¨ä»»ä½•æœåŠ¡å™¨ä¸Šä¸€è¡Œå¯åŠ¨
docker run -p 8080:8080 -p 9000:9000 ä½ çš„Dockerç”¨æˆ·å/wepoker:latest
```

### æ–¹æ¡ˆ 3ï¼šä½¿ç”¨ Herokuï¼ˆç®€å•ï¼‰

```bash
# 1. å®‰è£… Heroku CLI
# 2. heroku create wepoker
# 3. git push heroku main
# 4. å®Œæˆï¼åº”ç”¨éƒ¨ç½²åˆ° Heroku

# é“¾æ¥ï¼šhttps://wepoker.herokuapp.com?table=123456
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### é’ˆå¯¹å¤§é‡ç©å®¶

```yaml
spring:
  threads:
    virtual:
      enabled: true  # å¯ç”¨ Java 21 è™šæ‹Ÿçº¿ç¨‹

wepoker:
  netty:
    workerThreads: 16  # å¢åŠ  worker çº¿ç¨‹æ•°
    
  datasource:
    hikari:
      maximum-pool-size: 30  # å¢åŠ æ•°æ®åº“è¿æ¥æ± 
```

### ç›‘æ§æ€§èƒ½

```bash
# æŸ¥çœ‹ Java è¿›ç¨‹å†…å­˜ä½¿ç”¨
jps -l
jstat -gc <pid> 1000

# æŸ¥çœ‹ Redis å†…å­˜
docker exec wepoker-redis redis-cli INFO memory

# æŸ¥çœ‹ MySQL è¿æ¥æ•°
docker exec wepoker-mysql mysql -u root -proot -e "SHOW PROCESSLIST;"
```

---

## ğŸ” ç”Ÿäº§ç¯å¢ƒå®‰å…¨å»ºè®®

```bash
# 1. å¯ç”¨ HTTPS
# ä½¿ç”¨ Nginx åå‘ä»£ç† + Let's Encrypt

# 2. é™æµ
# æ·»åŠ é€Ÿç‡é™åˆ¶ï¼Œé˜²æ­¢ DDoS

# 3. è‡ªç­¾åè¯ä¹¦ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰
keytool -genkey -alias wepoker -keyalg RSA \
  -keystore wepoker.jks -storepass password

# åœ¨ application.yml ä¸­é…ç½®ï¼š
server:
  ssl:
    key-store: wepoker.jks
    key-store-password: password

# 4. å®šæœŸå¤‡ä»½
# å¤‡ä»½ MySQL å’Œ Redis æ•°æ®

# 5. ç›‘æ§å‘Šè­¦
# ä½¿ç”¨ Prometheus + Grafana
```

---

## ğŸ“ å¸¸è§éƒ¨ç½²é—®é¢˜

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|---------|
| **ç«¯å£å·²è¢«å ç”¨** | ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ portï¼Œæˆ– `kill` å ç”¨è¿›ç¨‹ |
| **å†…å­˜ä¸è¶³** | å¢åŠ  Docker å†…å­˜é™åˆ¶æˆ–å‡çº§æœåŠ¡å™¨ |
| **ç½‘ç»œè¶…æ—¶** | æ£€æŸ¥é˜²ç«å¢™è§„åˆ™ï¼Œç¡®ä¿ç«¯å£å¼€æ”¾ |
| **HTTPS è¯ä¹¦é”™è¯¯** | ä½¿ç”¨è‡ªç­¾åè¯ä¹¦æˆ–ç”³è¯·å…è´¹è¯ä¹¦ |
| **æœ‹å‹æ— æ³•è¿æ¥** | æ£€æŸ¥å…¬ç½‘ IPï¼Œç¡®ä¿æœåŠ¡å™¨å¯è®¿é—® |

---

## ğŸ“ é«˜çº§éƒ¨ç½²

### Kubernetes éƒ¨ç½²ï¼ˆä¼ä¸šçº§ï¼‰

```bash
# 1. å‡†å¤‡ Kubernetes é›†ç¾¤
# 2. åˆ›å»º Dockerfile
# 3. æ¨é€é•œåƒ
# 4. åˆ›å»º k8s manifest
# 5. kubectl apply -f wepoker-deployment.yaml

# è‡ªåŠ¨ä¼¸ç¼©ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœè½¬ç§»å…¨éƒ¨è§£å†³ï¼
```

### å¤šåœ°åŸŸéƒ¨ç½²

```yaml
# åŒ—äº¬æœåŠ¡å™¨
åŒ—äº¬ Game Server â† â†’ Redis Cluster â† â†’ MySQL Master

# ä¸Šæµ·æœåŠ¡å™¨
ä¸Šæµ· Game Server â† â†’ Redis Cluster â† â†’ MySQL Slave

# ç”¨æˆ·è‡ªåŠ¨è·¯ç”±åˆ°æœ€è¿‘çš„æœåŠ¡å™¨
```

---

## âœ¨ æ€»ç»“

### æœ€ç®€å•çš„æ–¹å¼ï¼ˆæ¨èï¼‰

```bash
# å°±è¿™ä¸€è¡Œï¼
docker-compose up -d

# 2 åˆ†é’Ÿåï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€
# http://localhost:8080
# é‚€è¯·æœ‹å‹åŠ å…¥ï¼
```

### æœ€çµæ´»çš„æ–¹å¼

```bash
# è‡ªå·±ç¼–è¯‘ã€è‡ªå·±éƒ¨ç½²ï¼Œå®Œå…¨æ§åˆ¶
mvn clean package
java -jar target/texas-poker-1.0.0.jar
```

### æœ€ä¸“ä¸šçš„æ–¹å¼

```bash
# éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ï¼Œå…¨ä¸–ç•Œéƒ½èƒ½ç©
# Kubernetes + Docker + åˆ†å¸ƒå¼ Redis + MySQL
```

---

**é€‰æ‹©ä¸€ä¸ªæ–¹å¼ï¼Œ5 åˆ†é’Ÿæ­å»ºå®Œæˆï¼Œé‚€è¯·æœ‹å‹å¼€ç©ï¼** ğŸ‰

æœ‰é—®é¢˜æŸ¥çœ‹å¯¹åº”çš„æ•…éšœæ’æŸ¥éƒ¨åˆ†ï¼Œæˆ–æŸ¥çœ‹åº”ç”¨æ—¥å¿—ã€‚
